<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>AGFI • Iniciar sesión</title>
  <!-- Bootstrap 5.3 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Estilos personalizados -->
  <link href="/Frontend/Styles/index.css" rel="stylesheet">
</head>
<body>
  <main class="container py-4">
    <div class="card shadow auth-card mx-auto overflow-hidden">
      <div class="row g-0">
        <!-- Col izquierda: formulario -->
        <div class="col-12 col-lg-5 p-4 p-lg-5 bg-white">
          <div class="d-flex align-items-center gap-2 mb-3">
            <img src="/Frontend/Images/logo_AGFI.jpeg" class="brand-mark" alt="AGFI" onerror="this.style.display='none'">
            <strong>Sistema • AGFI </strong>
          </div>
          <p class="muted small mb-2">Accede para registrar asistencia o administrar eventos.</p>
          <h1 class="h3 fw-bold mb-4">Iniciar sesión</h1>

          <form id="loginForm" class="needs-validation" novalidate>
            <div class="mb-3">
              <label for="email" class="form-label">Correo</label>
              <input type="email" class="form-control" id="email" placeholder="tu@correo.com" required>
              <div class="invalid-feedback">Escribe un correo válido.</div>
            </div>
            <div class="mb-2">
              <label for="password" class="form-label">Contraseña</label>
              <input type="password" class="form-control" id="password" placeholder="••••••••" minlength="6" required>
              <div class="invalid-feedback">La contraseña debe tener al menos 6 caracteres.</div>
            </div>
            <div class="d-flex justify-content-end mb-2">
              <a href="#" id="recuperar" class="small">¿Olvidaste tu contraseña?</a>
            </div>

            <button class="btn btn-agfi text-white w-100" type="submit">Entrar</button>

            <div id="alert" class="alert mt-3 d-none" role="status" aria-live="polite"></div>
          </form>
        </div>

        <!-- Col derecha: imagen -->
        <div class="col-12 col-lg-7 side-image position-relative">
          <div class="position-absolute bottom-0 start-0 m-3 bg-dark bg-opacity-25 text-white rounded-pill px-3 py-2 d-flex align-items-center gap-2">
            <img src="/Frontend/Images/logo_AGFI.jpeg" class="brand-mark" style="height:28px" alt="AGFI" onerror="this.style.display='none'">
            <span class="fw-semibold small">UNAM Ingeniería</span>
          </div>
        </div>
      </div>
    </div>
  </main>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    // Validación Bootstrap + demo de login
    (function(){
      const form = document.getElementById('loginForm');
      const alertBox = document.getElementById('alert');

      function showAlert(type,msg){
        alertBox.className = 'alert mt-3 '+(type==='ok'?'alert-success':'alert-danger');
        alertBox.textContent = msg; alertBox.classList.remove('d-none');
      }

      form.addEventListener('submit', async (e)=>{
        e.preventDefault();
        e.stopPropagation();
        form.classList.add('was-validated');

        const email = document.getElementById('email').value.trim();
        const pass  = document.getElementById('password').value.trim();
        if(!/^[^@\s]+@[^@\s]+\.[^@\s]+$/.test(email) || pass.length < 6){
          return showAlert('err','Verifica tus datos.');
        }

        showAlert('ok','Validando…');
        await new Promise(r=>setTimeout(r,600));

        // DEMO local
        if(email==='admin@agfi.mx' && pass==='agfi123'){
          localStorage.setItem('agfi_role','admin');
          localStorage.setItem('agfi_token','demo-'+Math.random().toString(36).slice(2));
          return showAlert('ok','Acceso concedido (administrador).');
        }
        showAlert('err','Credenciales incorrectas.');

        // Ejemplo de integración real:
        // const res = await fetch('/auth/login',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({email, password:pass})});
        // if(res.ok){ const data = await res.json(); localStorage.setItem('agfi_token', data.token); }
      });

      document.getElementById('recuperar').addEventListener('click',(e)=>{
        e.preventDefault();
        const email = document.getElementById('email').value.trim();
        if(!email) return showAlert('err','Escribe tu correo para enviarte el enlace.');
        showAlert('ok','Te enviamos un enlace de recuperación a '+email+' (demo).');
      });

      document.getElementById('linkOtp').addEventListener('click',(e)=>{
        e.preventDefault();
        showAlert('ok','Modo OTP: ingresa tu correo y te enviaremos un código (prototipo).');
      });
    })();
  </script>
</body>
</html>
